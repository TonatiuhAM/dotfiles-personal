# ===================================================================
# ┌─' Configuración General y de Comportamiento ───────────────────┐
# ===================================================================

# Prefijo (Leader Key): Ctrl + a
unbind C-b
set-option -g prefix C-a
bind-key C-a send-prefix

# Habilitar el uso del ratóe
set -g mouse on

# Iniciar ventanas y paneles desde el índice 1 en lugar de 0
set -g base-index 1
setw -g pane-base-index 1

# Habilitar modo Vi para el modo copia y navegación
set-window-option -g mode-keys vi

# ===================================================================
# ├─' Apariencia y Colores (Theme) ─────────────────────────────────┤
# ===================================================================

set -g default-terminal "tmux-256color"
set -q -g utf8 on

set -sg terminal-overrides ",*:RGB"  # true color support
set-option -g terminal-overrides ",xterm*:Ss=\e[%p1%d q:Se=\e[2 q,screen*:Ss=\e[%p1%d q:Se=\e[2 q"

# Colocar la barra de estado en la parte superior
set-option -g status-position top

# ===================================================================
# ├─' Apariencia de la Barra (Estilo Tokyo Night) ──────────────────┤
# ===================================================================
# Fondo de la barra transparente (se adapta a tu terminal)
set -g status-style bg=default,fg="#7aa2f7"

# Limpiar los lados
set -g status-left " "  # Un pequeño espacio inicial
set -g status-right ""

# Alinear las ventanas a la izquierda
set -g status-justify left

# --- Ventanas Inactivas (Solo el número) ---
# Usamos un gris azulado (Tokyo Night storm) para lo que no está activo
set -g window-status-format "#[fg=#565f89,bg=default] #I "

# --- Ventana Activa (Número resaltado) ---
# Magenta vibrante, negrita y con un pequeño indicador visual
set -g window-status-current-format "#[fg=#bb9af7,bg=default,bold] #I "

# Separación entre los números para que no se vean amontonados
set -g window-status-separator " "

# opciones
set -g renumber-windows on

# Sepaaradores de ventanas
set -g pane-border-lines simple
set -g pane-border-style fg=black,bright
set -g pane-active-border-style fg=magenta

set -g escape-time 0
set -g history-limit 10000


# ===================================================================
# ├─' Atajos de Teclado (Keybindings) ──────────────────────────────┤
# ===================================================================

# Recargar la configuración con Prefijo + r
bind r source-file ~/.tmux.conf \; display "Configuración recargada!"

# Crear nuevas ventanas y paneles
bind v split-window -h -c "#{pane_current_path}" # Leader+V: split vertical
bind b split-window -v -c "#{pane_current_path}" # Leader+B: split horizontal
bind t new-window -c "#{pane_current_path}" # Leader+T: new window

# Navegar entre paneles con Prefijo + h/j/k/l (estilo Vim)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Redimensionar paneles con Prefijo + Ctrl + h/j/k/l
bind -r C-k resize-pane -U 5
bind -r C-j resize-pane -D 5
bind -r C-h resize-pane -L 5
bind -r C-l resize-pane -R 5

# Navegar entre ventanas con Option + H/L (sin prefijo)
bind -n M-H previous-window
bind -n M-L next-window

# Abrir lazygit en popup centrado con Prefijo + g
bind g display-popup -d '#{pane_current_path}' -w 80% -h 80% -E lazygit

# Cerrar panel con Prefijo + w
bind w kill-pane

# Atajos para el modo copia (estilo Vim)
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# ===================================================================
# ├─' Plugins (TPM) ────────────────────────────────────────────────┤
# ===================================================================

# Lista de plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank' # Copia al portapapeles del sistema

# Configuración de plugins
set -g @resurrect-strategy-vim 'session' # Restaura sesiones de vim/nvim
set -g @resurrect-strategy-nvim 'session' # Restaura sesiones de nvim
set -g @resurrect-capture-pane-contents 'on' # Captura contenido de paneles

# ===================================================================
# └─' Inicialización de TPM (SIEMPRE AL FINAL) ─────────────────────┘
# ===================================================================
run '~/.tmux/plugins/tpm/tpm'

